version: '3'

services:

  mysql:
    image: mariadb
    # container_name: withkid-rdb
    environment:
      MYSQL_ROOT_PASSWORD: 1234
      MYSQL_DATABASE: with-kid
    ports:
      - "3306:3306"
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /opt/mysql/data:/var/lib/mysql
    restart: always
    networks:
      - withkid-bridge  

  redis:
    image: redis
    # container_name: withkid-redis
    ports:
      - "3679:3679"
    volumes:
      - /opt/redis/data:/data
    restart: always
    networks: 
      - withkid-bridge

  nginx:
    build:
      context: ./image-storage/
    ports:
      - "37772:80"
    volumes:
      - /usr/share/nginx:/usr/share/nginx/imgFolder
    networks: 
      - withkid-bridge
networks:
  withkid-bridge: 
    external: true
